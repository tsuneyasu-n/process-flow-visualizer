# 業務プロセス可視化ツール - 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
**Process Flow Visualizer（プロセスフロー可視化ツール）**

### 1.2 目的
- 属人化した業務フローを可視化し、組織全体で共有可能にする
- ボトルネックをAIで自動検出し、改善提案を行う
- DX推進の「現状把握」フェーズを支援する

### 1.3 ターゲットユーザー
- DX推進担当者
- 業務改善担当者
- 部門マネージャー

---

## 2. 機能要件

### 2.1 フロー編集機能（コア機能）

| 機能 | 説明 | 優先度 |
|------|------|--------|
| ノード追加 | 業務ステップを表すノードを追加 | 必須 |
| ノード編集 | ノード名、担当者、所要時間を設定 | 必須 |
| ノード削除 | 不要なノードを削除 | 必須 |
| エッジ接続 | ノード間を矢印で接続 | 必須 |
| 分岐/合流 | 条件分岐、並列処理を表現 | 必須 |
| ドラッグ&ドロップ | ノードの位置を自由に配置 | 必須 |

### 2.2 ノードタイプ

| タイプ | 色 | 用途 |
|--------|-----|------|
| 開始 | 緑 | フローの開始点 |
| 終了 | 赤 | フローの終了点 |
| 作業 | 青 | 通常の業務ステップ |
| 判断 | 黄 | 条件分岐（ひし形） |
| 待機 | グレー | 承認待ち、外部待ち |

### 2.3 ノード属性

```typescript
interface ProcessNode {
  id: string;
  type: 'start' | 'end' | 'task' | 'decision' | 'wait';
  label: string;           // ステップ名
  assignee?: string;       // 担当者/部署
  duration?: number;       // 所要時間（分）
  description?: string;    // 詳細説明
  issues?: string[];       // 課題メモ
}
```

### 2.4 AI分析機能

| 機能 | 説明 | 優先度 |
|------|------|--------|
| ボトルネック検出 | 所要時間が長いステップを特定 | 必須 |
| 改善提案 | AIによる業務改善案の提示 | 必須 |
| 自動化候補 | 自動化可能なステップの提案 | 任意 |
| 重複検出 | 類似作業の統合提案 | 任意 |

### 2.5 保存/読込機能

| 機能 | 説明 | 優先度 |
|------|------|--------|
| ローカル保存 | ブラウザのlocalStorageに保存 | 必須 |
| JSON出力 | フローデータをJSONでエクスポート | 必須 |
| JSON読込 | JSONファイルからインポート | 必須 |
| 画像出力 | PNG/SVG形式でエクスポート | 任意 |

---

## 3. 非機能要件

### 3.1 技術スタック

| 項目 | 技術 |
|------|------|
| フレームワーク | Next.js 14 (App Router) |
| 言語 | TypeScript |
| フロー描画 | React Flow |
| スタイリング | Tailwind CSS |
| AI | OpenAI GPT-4o-mini |
| 状態管理 | Zustand |
| ホスティング | Vercel |

### 3.2 パフォーマンス
- 100ノードまでスムーズに動作
- 初期表示 3秒以内

### 3.3 対応ブラウザ
- Chrome（最新）
- Edge（最新）
- Firefox（最新）

---

## 4. 画面構成

### 4.1 メイン画面

```
┌─────────────────────────────────────────────────────────┐
│  Process Flow Visualizer            [保存] [読込] [分析]│
├─────────┬───────────────────────────────────────────────┤
│         │                                               │
│ ツール  │                                               │
│ パネル  │           フローキャンバス                     │
│         │          （React Flow）                       │
│ ・開始  │                                               │
│ ・終了  │                                               │
│ ・作業  │                                               │
│ ・判断  │                                               │
│ ・待機  │                                               │
│         │                                               │
├─────────┴───────────────────────────────────────────────┤
│  プロパティパネル / AI分析結果                          │
└─────────────────────────────────────────────────────────┘
```

### 4.2 画面一覧

| 画面 | パス | 説明 |
|------|------|------|
| メイン | `/` | フロー編集画面 |
| AI分析 | モーダル | 分析結果表示 |

---

## 5. データ構造

### 5.1 フローデータ

```typescript
interface FlowData {
  id: string;
  name: string;
  description?: string;
  nodes: ProcessNode[];
  edges: ProcessEdge[];
  createdAt: string;
  updatedAt: string;
}

interface ProcessEdge {
  id: string;
  source: string;
  target: string;
  label?: string;  // 条件ラベル（Yes/No等）
}
```

---

## 6. AI分析仕様

### 6.1 入力
- フロー全体のJSON
- 各ノードの属性（担当者、所要時間）

### 6.2 出力

```typescript
interface AnalysisResult {
  summary: string;           // 全体サマリー
  totalDuration: number;     // 総所要時間
  bottlenecks: {
    nodeId: string;
    reason: string;
    suggestion: string;
  }[];
  improvements: {
    category: string;        // 自動化/統合/削除
    description: string;
    impact: 'high' | 'medium' | 'low';
  }[];
}
```

---

## 7. 開発スケジュール

| フェーズ | 内容 | 工数 |
|----------|------|------|
| Phase 1 | プロジェクトセットアップ、UI基盤 | 1日 |
| Phase 2 | フロー編集機能 | 2日 |
| Phase 3 | AI分析機能 | 1.5日 |
| Phase 4 | 保存/読込機能 | 1日 |
| Phase 5 | デザイン調整、デモデータ | 1.5日 |
| **合計** | | **7日** |

---

## 8. 確認事項

以下についてご確認ください：

1. **ノードタイプ**: 上記5種類で十分ですか？追加したいタイプはありますか？
2. **AI分析**: OpenAI APIキーはお持ちですか？（ユーザー側で入力する形式にしますか？）
3. **保存方式**: localStorage（ブラウザ内）で良いですか？クラウド保存は必要ですか？
4. **デモデータ**: どのような業務フローをサンプルとして用意しますか？（例：経費精算、採用フロー等）
5. **言語**: UIは日本語/英語どちらにしますか？

---

## 承認欄

- [ ] 要件内容を確認しました
- [ ] 開発を開始してください
